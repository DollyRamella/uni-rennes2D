import{b as n}from"./main-40c79f74.js";import"./init-7741dda9.js";let t,i=[],s;WA.onInit().then(async()=>{n(),t=await WA.room.getTiledMap(),p(),l(),f(),c(),y()}).catch(e=>console.error(e));function l(){for(let e of t.layers)if(e.name==="drawZones"&&e.type==="objectgroup"){for(let o=0;o<e.objects.length;o++){let r=e.objects[o].properties;if(e.objects[o].class=="area"&&r!=null)for(let a of r)a.name==="associatedLayer"&&(a==null?void 0:a.value)!=null&&a.type==="string"&&i.push({name:e.objects[o].name,associatedlayers:a.value.split(",")})}break}}function f(){for(let e of i)for(let o of e.associatedlayers)WA.room.area.onEnter(e.name).subscribe(()=>{WA.room.showLayer(o)}),WA.room.area.onLeave(e.name).subscribe(()=>{WA.room.hideLayer(o)})}function m(e,o,r){return r.x<e&&e<r.x+r.width&&r.y<o&&o<r.y+r.height}async function c(){let e=await WA.player.getPosition();for(let o of i){let r=await WA.room.area.get(o.name);if(r!=null&&m(e.x,e.y,r)){for(let a of o.associatedlayers)WA.room.showLayer(a);return}}}function u(e,o){WA.room.setProperty("ExitZones/"+e,"exitUrl",void 0),WA.room.onEnterLayer("ExitZones/"+e).subscribe(()=>{s=WA.ui.displayActionMessage({message:"Go to room ?",callback:()=>{WA.nav.goToRoom(o)}})}),WA.room.onLeaveLayer("ExitZones/"+e).subscribe(()=>{setTimeout(()=>{s.remove()},1e3)})}function y(){for(let e of t.layers)if(e.name==="ExitZones"&&e.type==="group"&&(e==null?void 0:e.layers)!=null){for(let o of e.layers)if((o==null?void 0:o.properties)!=null)for(let r of o.properties)r.name==="exitUrl"&&(r==null?void 0:r.value)!=null&&r.type==="string"&&u(o.name,r.value)}}function p(){for(let e of t.layers)e.name!="collisions"&&e.name!="background"&&WA.room.hideLayer(e.name)}
